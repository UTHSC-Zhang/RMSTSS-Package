<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Find Sample Size for a Linear RMST Model (Analytic) — linear.ss.analytical • RMSTSS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Find Sample Size for a Linear RMST Model (Analytic) — linear.ss.analytical"><meta name="description" content="Calculates the required sample size for a target power using an
analytic formula based on the methods of Tian et al. (2014)."><meta property="og:description" content="Calculates the required sample size for a target power using an
analytic formula based on the methods of Tian et al. (2014)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RMSTSS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/RMSTSS.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Find Sample Size for a Linear RMST Model (Analytic)</h1>

      <div class="d-none name"><code>linear.ss.analytical.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the required sample size for a target power using an
analytic formula based on the methods of Tian et al. (2014).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">linear.ss.analytical</span><span class="op">(</span></span>
<span>  <span class="va">pilot_data</span>,</span>
<span>  <span class="va">time_var</span>,</span>
<span>  <span class="va">status_var</span>,</span>
<span>  <span class="va">arm_var</span>,</span>
<span>  <span class="va">target_power</span>,</span>
<span>  linear_terms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">L</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  n_start <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  n_step <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  max_n_per_arm <span class="op">=</span> <span class="fl">2000</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pilot-data">pilot_data<a class="anchor" aria-label="anchor" href="#arg-pilot-data"></a></dt>
<dd><p>A <code>data.frame</code> containing pilot study data.</p></dd>


<dt id="arg-time-var">time_var<a class="anchor" aria-label="anchor" href="#arg-time-var"></a></dt>
<dd><p>A character string specifying the name of the time-to-event variable.</p></dd>


<dt id="arg-status-var">status_var<a class="anchor" aria-label="anchor" href="#arg-status-var"></a></dt>
<dd><p>A character string specifying the name of the event status variable (1=event, 0=censored).</p></dd>


<dt id="arg-arm-var">arm_var<a class="anchor" aria-label="anchor" href="#arg-arm-var"></a></dt>
<dd><p>A character string specifying the name of the treatment arm variable (1=treatment, 0=control).</p></dd>


<dt id="arg-target-power">target_power<a class="anchor" aria-label="anchor" href="#arg-target-power"></a></dt>
<dd><p>A single numeric value for the desired power (e.g., 0.80 or 0.90).</p></dd>


<dt id="arg-linear-terms">linear_terms<a class="anchor" aria-label="anchor" href="#arg-linear-terms"></a></dt>
<dd><p>An optional character vector of other covariate names to include in the model.</p></dd>


<dt id="arg-l">L<a class="anchor" aria-label="anchor" href="#arg-l"></a></dt>
<dd><p>The numeric value for the RMST truncation time.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>The significance level (Type I error rate).</p></dd>


<dt id="arg-n-start">n_start<a class="anchor" aria-label="anchor" href="#arg-n-start"></a></dt>
<dd><p>The starting sample size <em>per arm</em> for the search.</p></dd>


<dt id="arg-n-step">n_step<a class="anchor" aria-label="anchor" href="#arg-n-step"></a></dt>
<dd><p>The increment in sample size at each step of the search.</p></dd>


<dt id="arg-max-n-per-arm">max_n_per_arm<a class="anchor" aria-label="anchor" href="#arg-max-n-per-arm"></a></dt>
<dd><p>The maximum sample size <em>per arm</em> to search up to.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>list</code> containing:</p>
<dl><dt>results_data</dt>
<dd><p>A <code>data.frame</code> with the target power and the required sample size per arm.</p></dd>

<dt>results_plot</dt>
<dd><p>A <code>ggplot</code> object visualizing the sample size search path.</p></dd>

<dt>results_summary</dt>
<dd><p>A <code>data.frame</code> summarizing the treatment effect from the pilot data used for the calculation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function performs an iterative search to find the sample size needed to
achieve a specified <code>target_power</code>. It uses the same underlying theory as
<code>linear.power.analytical</code>. First, it estimates the treatment effect size and its
asymptotic variance from the pilot data. Then, it iteratively calculates the
power for increasing sample sizes using the analytic formula until the
target power is achieved.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">pilot_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0.07</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Introduce an effect</span></span></span>
<span class="r-in"><span>  status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1</span>, <span class="fl">0.8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  arm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, each <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">55</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ss_results</span> <span class="op">&lt;-</span> <span class="fu">linear.ss.analytical</span><span class="op">(</span></span></span>
<span class="r-in"><span>  pilot_data <span class="op">=</span> <span class="va">pilot_df</span>,</span></span>
<span class="r-in"><span>  time_var <span class="op">=</span> <span class="st">"time"</span>,</span></span>
<span class="r-in"><span>  status_var <span class="op">=</span> <span class="st">"status"</span>,</span></span>
<span class="r-in"><span>  arm_var <span class="op">=</span> <span class="st">"arm"</span>,</span></span>
<span class="r-in"><span>  target_power <span class="op">=</span> <span class="fl">0.80</span>,</span></span>
<span class="r-in"><span>  L <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- Estimating parameters from pilot data for analytic search... ---</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Model: Y_rmst ~ factor(arm)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- Searching for Sample Size (Method: Analytic) ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 50/arm, Calculated Power = 0.034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 75/arm, Calculated Power = 0.037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 100/arm, Calculated Power = 0.039</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 125/arm, Calculated Power = 0.041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 150/arm, Calculated Power = 0.043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 175/arm, Calculated Power = 0.044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 200/arm, Calculated Power = 0.046</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 225/arm, Calculated Power = 0.048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 250/arm, Calculated Power = 0.049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 275/arm, Calculated Power = 0.051</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 300/arm, Calculated Power = 0.052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 325/arm, Calculated Power = 0.054</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 350/arm, Calculated Power = 0.055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 375/arm, Calculated Power = 0.057</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 400/arm, Calculated Power = 0.058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 425/arm, Calculated Power = 0.059</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 450/arm, Calculated Power = 0.061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 475/arm, Calculated Power = 0.062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 500/arm, Calculated Power = 0.064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 525/arm, Calculated Power = 0.065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 550/arm, Calculated Power = 0.066</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 575/arm, Calculated Power = 0.068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 600/arm, Calculated Power = 0.069</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 625/arm, Calculated Power = 0.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 650/arm, Calculated Power = 0.071</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 675/arm, Calculated Power = 0.073</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 700/arm, Calculated Power = 0.074</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 725/arm, Calculated Power = 0.075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 750/arm, Calculated Power = 0.077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 775/arm, Calculated Power = 0.078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 800/arm, Calculated Power = 0.079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 825/arm, Calculated Power = 0.08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 850/arm, Calculated Power = 0.082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 875/arm, Calculated Power = 0.083</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 900/arm, Calculated Power = 0.084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 925/arm, Calculated Power = 0.085</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 950/arm, Calculated Power = 0.087</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 975/arm, Calculated Power = 0.088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1000/arm, Calculated Power = 0.089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1025/arm, Calculated Power = 0.09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1050/arm, Calculated Power = 0.092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1075/arm, Calculated Power = 0.093</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1100/arm, Calculated Power = 0.094</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1125/arm, Calculated Power = 0.095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1150/arm, Calculated Power = 0.096</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1175/arm, Calculated Power = 0.098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1200/arm, Calculated Power = 0.099</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1225/arm, Calculated Power = 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1250/arm, Calculated Power = 0.101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1275/arm, Calculated Power = 0.103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1300/arm, Calculated Power = 0.104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1325/arm, Calculated Power = 0.105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1350/arm, Calculated Power = 0.106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1375/arm, Calculated Power = 0.107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1400/arm, Calculated Power = 0.109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1425/arm, Calculated Power = 0.11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1450/arm, Calculated Power = 0.111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1475/arm, Calculated Power = 0.112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1500/arm, Calculated Power = 0.113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1525/arm, Calculated Power = 0.115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1550/arm, Calculated Power = 0.116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1575/arm, Calculated Power = 0.117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1600/arm, Calculated Power = 0.118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1625/arm, Calculated Power = 0.119</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1650/arm, Calculated Power = 0.121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1675/arm, Calculated Power = 0.122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1700/arm, Calculated Power = 0.123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1725/arm, Calculated Power = 0.124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1750/arm, Calculated Power = 0.125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1775/arm, Calculated Power = 0.127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1800/arm, Calculated Power = 0.128</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1825/arm, Calculated Power = 0.129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1850/arm, Calculated Power = 0.13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1875/arm, Calculated Power = 0.131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1900/arm, Calculated Power = 0.133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1925/arm, Calculated Power = 0.134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1950/arm, Calculated Power = 0.135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 1975/arm, Calculated Power = 0.136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N = 2000/arm, Calculated Power = 0.137</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Target power 0.8 not achieved by max N of 2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- Calculation Summary ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Table: Required Sample Size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | Target_Power| Required_N_per_Arm|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |------------:|------------------:|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |          0.8|               2000|</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ss_results</span><span class="op">$</span><span class="va">results_data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Target_Power Required_N_per_Arm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          0.8               2000</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ss_results</span><span class="op">$</span><span class="va">results_plot</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="linear.ss.analytical-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Arnab Aich.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

