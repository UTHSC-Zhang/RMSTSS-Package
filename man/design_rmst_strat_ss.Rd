% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multiplicative_stratified.R
\name{design_rmst_strat_ss}
\alias{design_rmst_strat_ss}
\title{Estimate Sample Size for a Multiplicative Stratified RMST Model}
\usage{
design_rmst_strat_ss(
  pilot_data,
  time_var,
  status_var,
  arm_var,
  strata_var,
  target_power = NULL,
  linear_terms = NULL,
  tau,
  n_sim = 1000,
  alpha = 0.05,
  parallel.cores = 1,
  patience = 5,
  n_start = 50,
  n_step = 25,
  max_n_per_arm = 2000
)
}
\arguments{
\item{pilot_data}{A data.frame with pilot study data.}

\item{time_var, status_var, arm_var, strata_var}{Strings for column names.}

\item{target_power}{A single numeric value for the target power (e.g., 0.80).}

\item{linear_terms}{Optional vector of covariates for the model. If NULL,
defaults to all other columns in \code{pilot_data}.}

\item{tau}{The truncation time for RMST.}

\item{n_sim}{Number of bootstrap simulations.}

\item{alpha}{The significance level.}

\item{parallel.cores}{Number of cores for parallel processing. Default is 1.}

\item{patience}{Number of consecutive non-improving steps in the sample size
search before terminating that search. Default is 5.}

\item{n_start}{Starting sample size per stratum for the search.}

\item{n_step}{Increment for the sample size search.}

\item{max_n_per_arm}{Maximum sample size per stratum to try.}
}
\value{
A list containing \code{results_data} (a data.frame with the target power and
required N), \code{results_plot} (a ggplot object showing the search path), and \code{results_summary}
(a data.frame with the estimated treatment effect).
}
\description{
Performs sample size estimation based on the multiplicative model
for RMST (Wang et al., 2019), designed for stratified trials. This function
finds the required sample size to achieve a given target power.
}
\note{
\code{status_var} should be \code{1}/\code{0}. \code{arm_var} should be \code{1}/\code{0}. \code{strata_var}
is a mandatory argument.
}
\examples{
# Create a small pilot dataset with strata
pilot_data_strat <- data.frame(
  time = rexp(120, rate = 0.15),
  status = rbinom(120, 1, 0.6),
  arm = rep(0:1, each = 60),
  region = factor(rep(c("A", "B", "C"), each = 40)),
  age = rnorm(120, 55, 8)
)

# --- Sample Size Calculation with Parallel Processing ---
results_n_strat <- design_rmst_strat_ss(
  pilot_data = pilot_data_strat,
  time_var = "time",
  status_var = "status",
  arm_var = "arm",
  strata_var = "region",
  target_power = 0.80,
  tau = 10,
  n_sim = 50, # Low n_sim for example speed
  parallel.cores = 2,
  patience = 3
)
print(results_n_strat$results_plot)

}
\references{
Wang, X., et al. (2019). \emph{Statistics in Medicine}, 38, 5133-5145.
}
