% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/additive_stratified_analytical.R
\name{additive.ss.analytical}
\alias{additive.ss.analytical}
\title{Find Sample Size for a Stratified Additive RMST Model (Analytic)}
\usage{
additive.ss.analytical(
  pilot_data,
  time_var,
  status_var,
  arm_var,
  strata_var,
  target_power,
  linear_terms = NULL,
  tau,
  alpha = 0.05,
  n_start = 50,
  n_step = 25,
  max_n_per_arm = 2000
)
}
\arguments{
\item{pilot_data}{A \code{data.frame} containing pilot study data.}

\item{time_var}{A character string for the time-to-event variable.}

\item{status_var}{A character string for the event status variable (1=event, 0=censored).}

\item{arm_var}{A character string for the treatment arm variable (1=treatment, 0=control).}

\item{strata_var}{A character string for the stratification variable.}

\item{target_power}{A single numeric value for the desired power.}

\item{linear_terms}{An optional character vector of other covariate names.}

\item{tau}{The numeric value for the RMST truncation time.}

\item{alpha}{The significance level (Type I error rate).}

\item{n_start}{The starting sample size \emph{per stratum} for the search.}

\item{n_step}{The increment in sample size at each step of the search.}

\item{max_n_per_arm}{The maximum sample size \emph{per stratum} to search up to.}
}
\value{
A \code{list} containing:
\item{results_data}{A \code{data.frame} with the target power and required sample size.}
\item{results_plot}{A \code{ggplot} object visualizing the search path.}
\item{results_summary}{A \code{data.frame} summarizing the estimated treatment effect.}
}
\description{
Calculates the required sample size for a target power using the analytic
method for a stratified, additive RMST model.
}
\details{
This function performs an iterative search for the sample size required to
achieve a specified \code{target_power}. It uses the same underlying theory as
\code{additive.power.analytical}, based on stratum-centering of covariates. It performs
a one-time estimation of the additive treatment effect and its asymptotic variance
from the pilot data, then uses these parameters in an analytic formula to
efficiently find the required sample size.
}
\examples{
set.seed(456)
pilot_df_strat <- data.frame(
 time = rexp(200, 0.15),
 status = rbinom(200, 1, 0.7),
 arm = rep(0:1, each = 100),
 region = factor(rep(c("A", "B"), each = 100))
)
# Introduce a clear additive treatment effect
pilot_df_strat$time[pilot_df_strat$arm == 1] <-
  pilot_df_strat$time[pilot_df_strat$arm == 1] + 2.0

ss_results <- additive.ss.analytical(
  pilot_data = pilot_df_strat,
  time_var = "time", status_var = "status", arm_var = "arm", strata_var = "region",
  target_power = 0.80,
  tau = 10,
  n_start = 100, n_step = 50
)
print(ss_results$results_data)
print(ss_results$results_plot)

}
