% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/additive_gam.R
\name{design_rmst_additive_gam}
\alias{design_rmst_additive_gam}
\title{Analyze Power/Sample Size for an Additive RMST Model}
\usage{
design_rmst_additive_gam(
  pilot_data,
  time_var,
  status_var,
  arm_var,
  strata_var = NULL,
  sample_sizes = NULL,
  target_powers = NULL,
  linear_terms = NULL,
  smooth_terms = NULL,
  tau,
  n_sim = 1000,
  alpha = 0.05,
  parallel.cores = 1,
  patience = 5,
  n_start = 50,
  n_step = 25,
  max_n_per_arm = 2000
)
}
\arguments{
\item{pilot_data}{A data.frame containing pilot study data.}

\item{time_var, status_var, arm_var}{Strings specifying column names.}

\item{strata_var}{An optional string for a stratification variable.}

\item{sample_sizes}{Optional numeric vector of sample sizes per arm/stratum.}

\item{target_powers}{Optional numeric vector of target power levels.}

\item{linear_terms}{Optional character vector of covariates with a linear effect.}

\item{smooth_terms}{Optional character vector of covariates with a non-linear (spline) effect.}

\item{tau}{The truncation time for RMST.}

\item{n_sim}{Number of bootstrap simulations.}

\item{alpha}{The significance level.}

\item{parallel.cores}{Number of cores for parallel processing. Default is 1 (no parallel).}

\item{patience}{Number of consecutive non-improving steps in the sample size
search before terminating that search. Default is 5.}

\item{n_start, n_step, max_n_per_arm}{Search parameters for sample size mode.}
}
\value{
A list containing \code{results_data}, \code{results_plot}, and \code{results_summary}.
\code{results_summary} provides the mean, standard error, and confidence interval for the
estimated RMST difference between treatment arms.
}
\description{
Performs power or sample size analysis for a two-arm study using
a flexible, semiparametric additive model for the RMST. This method allows
for non-linear covariate effects via splines and supports optional stratification.
}
\details{
This function uses a bootstrap-based approach on a pilot dataset.
The core estimation is performed by fitting a Generalized Additive Model
(GAM) from the \code{mgcv} package to jackknife pseudo-observations of the RMST.
The user can specify which covariates have linear effects and which have
smooth, non-linear effects.
}
\note{
This function assumes the data is pre-processed.
\code{status_var} should be coded as \code{1} for an event and \code{0} for censored.
\code{arm_var} should be coded as \code{1} for the treatment/experimental group and \code{0} for the control group.
}
\examples{
# Create a small pilot dataset for the example
pilot_data_gam <- data.frame(
  surv_time = rexp(100, rate = 0.1),
  censor_status = rbinom(100, 1, 0.7),
  arm = rep(0:1, each = 50),
  age = rnorm(100, 50, 10),
  biomarker = rnorm(100, 10, 3)
)

# --- Power Calculation with Smooth Term ---
# Fast-running example for CRAN checks
results_power_gam <- design_rmst_additive_gam(
  pilot_data = pilot_data_gam,
  time_var = "surv_time",
  status_var = "censor_status",
  arm_var = "arm",
  linear_terms = "age",
  smooth_terms = "biomarker",
  sample_sizes = c(100),
  tau = 10,
  n_sim = 10 # Low n_sim for example speed
)

\donttest{
# --- Sample Size Calculation with Parallel Processing ---
# This example is more intensive and demonstrates parallel computing.
results_n_gam <- design_rmst_additive_gam(
  pilot_data = pilot_data_gam,
  time_var = "surv_time",
  status_var = "censor_status",
  arm_var = "arm",
  target_powers = c(0.80),
  tau = 10,
  n_sim = 100,
  parallel.cores = 2
)
}

}
\references{
Zhang, Y., & Schaubel, D. E. (2024). \emph{Biometrical Journal}.
}
